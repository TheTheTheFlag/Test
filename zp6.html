
<html>
     <head>
	     <title>表格编辑</title>
		 <script>
		     var num=1;
			 function addRow(){
			     var userName=document.getElementById("userName").value;
				 var userSexM=document.getElementById("userSexM");
				 var userSexW=document.getElementById("userSexW");
				 var userSex="";
				     if(userSexM.checked){
					     userSex="男";
					 }
					 if(userSexW.checked){
					     userSex="女";
					 }
			 var userClass=document.getElementById("userClass").value;
			 var userPro=document.getElementById("userPro").value;
			 var userScho=document.getElementById("userScho").value;
			 
			 if(userName==""||userName==null){
			     alert("请输入用户名");
				 return;
			 }
			 if(userSex==""||userSex==null){
			     alert("请选择性别");
				 return;
			 }
			 if(userPro==""||userPro==null){
			     alert("请选择专业");
				 return;
			 }
			 if(userClass==""||userClass==null){
			     alert("请选择班级");
				 return;
			 }
			 if(userScho==""||userScho==null){
			     alert("请选择学校");
				 return;
			 }
			 var ta=document.getElementById("ta");
			 var row=ta.insertRow()
			 
			 row.setAttribute("id","tr"+num);
			 row.setAttribute("align","center");
			 
			 var acel=row.insertCell();
			 acel.innerText=userName;
			 var acel=row.insertCell();
			 acel.innerText=userSex;
			 var acel=row.insertCell();
			 acel.innerText=userScho;
			 var acel=row.insertCell();
			 acel.innerText=userPro;
			 var acel=row.insertCell();
			 acel.innerText=userClass;
			 
			 var acel=row.insertCell();
			 acel.innerHTML='<input type="button" value="修改" onclick="edit(\'tr'+num+'\',this)"/>';
			 var acel=row.insertCell();
			 acel.innerHTML='<input type="button" value="删除" onclick="del(\'tr'+num+'\')"/>';
			 num++;
			 addBgColor();
			 ceal();
		 }
		 function ceal(){
		     document.getElementById("userName").value="";
			 document.getElementById("userSexM").checked=false;
			 document.getElementById("userName").checked=false;
			 document.getElementById("userScho").value="";
			 document.getElementById("userPro").value="";
			 document.getElementById("userClass").value="";
		 }
         function edit(t,obj){
             if(obj.value=='修改'){
                 var tr=document.getElementById(t);
                 var i=t.substr(2,1);
                 var num=tr.cells;
                 var userName=tr.cells[0].outerText;
                 var userSex=tr.cells[1].outerText;
                 var userScho=tr.cells[2].outerText;
                 var userPro=tr.cells[3].outerText;
                 var userClass=tr.cells[4].outerText;
				 
				 tr.cells[0].innerHTML="<input type='text' size='15' id='userName"+i+"' value='"+userName+"'   />"
				 tr.cells[1].innerHTML="<input type='text' size='10' id='userSex"+i+"' value='"+userSex+"'   />"
				 tr.cells[2].innerHTML="<input type='text' size='15' id='userScho"+i+"' value='"+userScho+"'   />"
				 tr.cells[3].innerHTML="<input type='text' size='15' id='userPro"+i+"' value='"+userPro+"'   />"
				 tr.cells[4].innerHTML="<input type='text' size='15' id='userClass"+i+"' value='"+userClass+"'   />"
				 obj.value="完成";
			 }else if(obj.value=='完成'){
			     var tr=document.getElementById(t);
				 var i=t.substr(2,1);
				 var userName=document.getElementById("userName"+i).value;
				 var userSex=document.getElementById("userSex"+i).value;
				 var userScho=document.getElementById("userScho"+i).value;
				 var userPro=document.getElementById("userPro"+i).value;
				 var userClass=document.getElementById("userClass"+i).value;
				 tr.cells[0].innerText=userName;
				 tr.cells[1].innerText=userSex;
				 tr.cells[2].innerText=userScho;
				 tr.cells[3].innerText=userPro;
				 tr.cells[4].innerText=userClass;
				 obj.value="修改";
			 }
		 }
		 function del(t){
		     var tt=document.getElementById(t);
			 ta.deleteRow(tt.rowIndex);
			 addBgColor();
		 }
		 function addBgColor(){
		     var ta=document.getElementById("ta");
			 var n=ta.row.length;
			 for(var i=0;i<n;i++){
			     if(ta.rows[i].rowIndex%2==0){
				     ta.rows[i].setAttribute("bgColor","#FDF5E6");
				 }else{
				     ta.rows[i].setAttribute("bgColor","#ffffff");
				 }
			 }
		 }
		 function addProfessional(){
		     var Scho=document.getElementById("userScho");
			 var professional=document.getElementById("userPro");
			 if(Scho.value==""){
			     alert("请选择学校!");
			 }
			 if(Scho.value=="dl"){
			     delOption(professional);
				 var pro1=new Option("请选择","");
				 var pro2=new Option("Java","Java");
				 var pro3=new Option(".Net",".Net");
				 var pro4=new Option("3G","3G");
				 var pro5=new Option("PHP","PHP");
				 professional.add(pro1);
				 professional.add(pro2);
				 professional.add(pro3);
				 professional.add(pro4);
				 professional.add(pro5);
			 }
			 if(Scho.value=="am"){
			     delOption(professional);
				 var pro1=new Option("请选择","");
				 var pro2=new Option("软件","软件");
				 var pro3=new Option("网络","网络");
				 var pro4=new Option("嵌入式","嵌入式");
				 professional.add(pro1);
				 professional.add(pro2);
				 professional.add(pro3);
				 professional.add(pro4);
			 }
			 if(Scho.value=="ht"){
			     delOption(professional);
				 var pro1=new Option("请选择","");
				 var pro2=new Option("软件工程","软件工程");
				 var pro3=new Option("会计","会计");
				 var pro4=new Option("体育","体育");
				 professional.add(pro1);
				 professional.add(pro2);
				 professional.add(pro3);
				 professional.add(pro4);
			 }
		 }
		 function addClass(){
		     var professional=document.getElementById("userPro");
			 var classOption=document.getElementById("userClass");
			 switch(professional.value){
				 case"软件工程":
				     delOption(classOption);
					 classOption.add(new Option("软件06","软件06"));
					 classOption.add(new Option("软件07","软件07"));
					 classOption.add(new Option("软件08","软件08"));
					 break;
				 case"会计":
				     delOption(classOption);
					 classOption.add(new Option("会计06","会计06"));
					 classOption.add(new Option("会计07","会计07"));
					 classOption.add(new Option("会计08","会计08"));
					 break;
				 case"体育":
				     delOption(classOption);
					 classOption.add(new Option("体育06","体育06"));
					 classOption.add(new Option("体育07","体育07"));
					 classOption.add(new Option("体育08","体育08"));
					 break;
				 case"软件":
				     delOption(classOption);
					 classOption.add(new Option("软件06","软件06"));
					 classOption.add(new Option("软件07","软件07"));
					 classOption.add(new Option("软件08","软件08"));
					 break;
				 case"网络":
				     delOption(classOption);
					 classOption.add(new Option("网络06","网络06"));
					 classOption.add(new Option("网络07","网络07"));
					 classOption.add(new Option("网络08","网络08"));
					 break;
				 case"嵌入式":
				     delOption(classOption);
					 classOption.add(new Option("嵌入式06","嵌入式06"));
					 classOption.add(new Option("嵌入式07","嵌入式07"));
					 classOption.add(new Option("嵌入式08","嵌入式08"));
					 break;
				 case"Java":
				     delOption(classOption);
					 classOption.add(new Option("Java06","Java06"));
					 classOption.add(new Option("Java07","Java07"));
					 classOption.add(new Option("Java08","Java08"));
					 break;
				 case"3G":
				     delOption(classOption);
					 classOption.add(new Option("3G06","3G06"));
					 classOption.add(new Option("3G07","3G07"));
					 classOption.add(new Option("3G08","3G08"));
					 break;
				 case".Net":
				     delOption(classOption);
					 classOption.add(new Option(".Net06",".Net06"));
					 classOption.add(new Option(".Net07",".Net07"));
					 classOption.add(new Option(".Net08",".Net08"));
					 break;
				 case"PHP":
				     delOption(classOption);
					 classOption.add(new Option("PHP06","PHP06"));
					 classOption.add(new Option("PHP07","PHP07"));
					 classOption.add(new Option("PHP08","PHP08"));
					 break;
				 default:
				     alert("请选择班级");
					 break;
				 }
				 }
                 function delOption(obj){
                     for(var i=obj.length-1;i>=0;i--){
                         obj.remove(i);
                     }
                 }					 
         </script>
         <style>
             *{
                 font-size:12px;
             }
         </style>
     </head>
     <body>
         <table align="center" width="1000" border="0">
             <tr>
                 <td align="center" valign="top" height="50">
                 <hr/>				 
				 <fieldset>
				     <legend>
					 <b>学生信息添加</b>
					 </legend>
					 <br/>
					 姓名:<input type="text" id="userName"/>
					 性别:<input type="radio" name="userSex" id="userSexM" value="男"/>男
			              <input type="radio" name="userSex" id="userSexW" value="女"/>女
				     学校:<select id="userScho" onChange="addProfessional()">
					         <option value="">请选择学校</option>
							 <option value="dl">大连希望</option>
							 <option value="am">安博教育</option>
							 <option value="ht">河套大学</option>
				          </select>
					 专业:<select id="userPro" onChange="addClass()">
					         <option value="">请选择专业</option>
				          </select>
					 班级:<select id="userClass">
					         <option value="">请选择班级</option>
				          </select>
                     <input type="button" value="添加" onclick="addRow()"/>
					 <input type="button" value="重置" onclick="ceal()"/>
					 <br/>
					 <br/>
				 </fieldset>
			 </td>
		 </tr>

		 <tr valign="top">
		     <td align="center">
			     <hr />
				 <fieldset style="height:550px">
				     <legend>
					     <b>学生信息管理</b>
					 </legend>
					 <br/>
				     <table id="ta" border="1" width="1000" align="center" bordercolor="#000">
				     <tr align="center" bgcolor="#FDF5E6">
					     <td>姓名</td>
						 <td>性别</td>
						 <td>学校</td>
						 <td>专业</td>
						 <td>班级</td>
						 <td colspan="2">编辑</td>
					 </tr>
					 <tr id="tr0" align="center">
					     <td>李明杨</td>
						 <td>女</td>
						 <td>安博教育</td>
						 <td>软件工程</td>
						 <td>Java10班</td>
						 <td><input type='button' value='修改' id="edit0" onclick="edit('tr0',this)"/></td>
						 <td><input type='button' value='删除' onclick="del('tr0')"/></td>
                   </tr>
				 </table>
				 </fieldset>
				 <hr/>
			 </td>
		 </tr>
	 </table>
	</body>
	</html>
